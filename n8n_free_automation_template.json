{
  "name": "Kostenlose Social Media Automation",
  "nodes": [
    {
      "parameters": {
        "updates": [
          {
            "name": "message",
            "value": "={{ $json.message.text }}"
          },
          {
            "name": "chat_id",
            "value": "={{ $json.chat.id }}"
          },
          {
            "name": "user_id",
            "value": "={{ $json.from.id }}"
          },
          {
            "name": "username",
            "value": "={{ $json.from.username }}"
          }
        ]
      },
      "id": "telegram-trigger",
      "name": "Telegram Bot Trigger",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1,
      "position": [240, 300],
      "webhookId": "telegram-bot"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "command-check",
              "leftValue": "={{ $json.message.text }}",
              "rightValue": "/start",
              "operator": {
                "type": "string",
                "operation": "startsWith"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "command-filter",
      "name": "Befehl Filter",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [460, 300]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chat_id }}",
        "text": "üé¨ Willkommen zur kostenlosen Social Media Automation!\n\nVerf√ºgbare Befehle:\n/video [text] - Video mit Avatar generieren\n/avatar [name] - Avatar erstellen\n/upload [platform] - Video hochladen\n\nBeispiel: /video Hallo Welt!"
      },
      "id": "welcome-message",
      "name": "Willkommensnachricht",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [680, 200]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "video-command",
              "leftValue": "={{ $json.message.text }}",
              "rightValue": "/video",
              "operator": {
                "type": "string",
                "operation": "startsWith"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "video-command-filter",
      "name": "Video Befehl",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [680, 400]
    },
    {
      "parameters": {
        "jsCode": "// Text aus Telegram-Nachricht extrahieren\nconst message = $input.first().json.message.text;\nconst videoText = message.replace('/video', '').trim();\n\nif (!videoText) {\n  return {\n    json: {\n      error: true,\n      message: 'Bitte geben Sie einen Text f√ºr das Video an. Beispiel: /video Hallo Welt!'\n    }\n  };\n}\n\nreturn {\n  json: {\n    video_text: videoText,\n    chat_id: $input.first().json.chat_id,\n    user_id: $input.first().json.user_id,\n    username: $input.first().json.username,\n    timestamp: new Date().toISOString()\n  }\n};"
      },
      "id": "extract-video-text",
      "name": "Video Text extrahieren",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 400]
    },
    {
      "parameters": {
        "url": "https://api.elevenlabs.io/v1/text-to-speech/21m00Tcm4TlvDq8ikWAM",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "xi-api-key",
              "value": "{{ $env.ELEVENLABS_API_KEY }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "text",
              "value": "={{ $json.video_text }}"
            },
            {
              "name": "model_id",
              "value": "eleven_monolingual_v1"
            },
            {
              "name": "voice_settings",
              "value": "{\"stability\": 0.5, \"similarity_boost\": 0.5}"
            }
          ]
        },
        "options": {}
      },
      "id": "text-to-speech",
      "name": "Text zu Sprache (ElevenLabs)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1120, 400]
    },
    {
      "parameters": {
        "url": "https://api.d-id.com/talks",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Basic {{ $env.DID_API_KEY }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "script",
              "value": "{\"type\": \"text\", \"input\": \"={{ $json.video_text }}\"}"
            },
            {
              "name": "config",
              "value": "{\"fluent\": true, \"pad_audio\": 0.0}"
            },
            {
              "name": "source_url",
              "value": "https://create-images-results.d-id.com/DefaultPresenters/Noelle_f/image.jpeg"
            }
          ]
        },
        "options": {}
      },
      "id": "create-avatar-video",
      "name": "Avatar Video erstellen (D-ID)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1340, 400]
    },
    {
      "parameters": {
        "url": "https://api.d-id.com/talks/={{ $json.id }}/status",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Basic {{ $env.DID_API_KEY }}"
            }
          ]
        },
        "options": {}
      },
      "id": "check-video-status",
      "name": "Video Status pr√ºfen",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1560, 400]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "status-check",
              "leftValue": "={{ $json.status }}",
              "rightValue": "done",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "video-ready-check",
      "name": "Video fertig?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [1780, 400]
    },
    {
      "parameters": {
        "url": "={{ $json.result_url }}",
        "options": {}
      },
      "id": "download-video",
      "name": "Video herunterladen",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [2000, 300]
    },
    {
      "parameters": {
        "chatId": "={{ $('extract-video-text').first().json.chat_id }}",
        "binaryData": true,
        "binaryPropertyName": "data",
        "additionalFields": {
          "caption": "üé¨ Ihr Video ist fertig!\n\nText: {{ $('extract-video-text').first().json.video_text }}"
        }
      },
      "id": "send-video-telegram",
      "name": "Video an Telegram senden",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [2220, 300]
    },
    {
      "parameters": {
        "url": "https://api.unsplash.com/photos/random",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "query",
              "value": "avatar profile"
            },
            {
              "name": "client_id",
              "value": "{{ $env.UNSPLASH_API_KEY }}"
            }
          ]
        },
        "options": {}
      },
      "id": "get-avatar-image",
      "name": "Avatar Bild holen (Unsplash)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [900, 600]
    },
    {
      "parameters": {
        "url": "https://api.remove.bg/v1.0/removebg",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-Api-Key",
              "value": "{{ $env.REMOVEBG_API_KEY }}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "image_url",
              "value": "={{ $json.urls.regular }}"
            },
            {
              "name": "size",
              "value": "auto"
            }
          ]
        },
        "options": {}
      },
      "id": "remove-background",
      "name": "Hintergrund entfernen (Remove.bg)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1120, 600]
    },
    {
      "parameters": {
        "url": "https://api.cloudinary.com/v1_1/{{ $env.CLOUDINARY_CLOUD_NAME }}/image/upload",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "file",
              "value": "={{ $json.data }}"
            },
            {
              "name": "api_key",
              "value": "{{ $env.CLOUDINARY_API_KEY }}"
            },
            {
              "name": "timestamp",
              "value": "={{ Math.floor(Date.now() / 1000) }}"
            }
          ]
        },
        "options": {}
      },
      "id": "upload-avatar",
      "name": "Avatar hochladen (Cloudinary)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1340, 600]
    },
    {
      "parameters": {
        "chatId": "={{ $('extract-video-text').first().json.chat_id }}",
        "text": "üñºÔ∏è Avatar erstellt und hochgeladen!\n\nURL: {{ $json.secure_url }}\n\nSie k√∂nnen diesen Avatar jetzt f√ºr Videos verwenden."
      },
      "id": "send-avatar-url",
      "name": "Avatar URL senden",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1560, 600]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "upload-command",
              "leftValue": "={{ $json.message.text }}",
              "rightValue": "/upload",
              "operator": {
                "type": "string",
                "operation": "startsWith"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "upload-command-filter",
      "name": "Upload Befehl",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [680, 800]
    },
    {
      "parameters": {
        "jsCode": "// Upload-Text extrahieren\nconst message = $input.first().json.message.text;\nconst parts = message.split(' ');\nconst platform = parts[1] || 'instagram';\n\nreturn {\n  json: {\n    platform: platform,\n    chat_id: $input.first().json.chat_id,\n    user_id: $input.first().json.user_id,\n    username: $input.first().json.username\n  }\n};"
      },
      "id": "extract-upload-info",
      "name": "Upload Info extrahieren",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [900, 800]
    },
    {
      "parameters": {
        "url": "http://localhost:5000/login",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "platform",
              "value": "={{ $json.platform }}"
            },
            {
              "name": "username",
              "value": "{{ $env.SOCIAL_USERNAME }}"
            },
            {
              "name": "password",
              "value": "{{ $env.SOCIAL_PASSWORD }}"
            }
          ]
        },
        "options": {}
      },
      "id": "social-login",
      "name": "Social Media Login",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1120, 800]
    },
    {
      "parameters": {
        "url": "http://localhost:5000/upload",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "platform",
              "value": "={{ $json.platform }}"
            },
            {
              "name": "video_url",
              "value": "={{ $('download-video').first().json.data }}"
            },
            {
              "name": "caption",
              "value": "={{ $('extract-video-text').first().json.video_text }}"
            }
          ]
        },
        "options": {}
      },
      "id": "upload-to-social",
      "name": "Video hochladen",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1340, 800]
    },
    {
      "parameters": {
        "chatId": "={{ $('extract-upload-info').first().json.chat_id }}",
        "text": "‚úÖ Video erfolgreich auf {{ $('extract-upload-info').first().json.platform }} hochgeladen!\n\nCaption: {{ $('extract-video-text').first().json.video_text }}"
      },
      "id": "upload-success",
      "name": "Upload Erfolg",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [1560, 800]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chat_id }}",
        "text": "‚è≥ Video wird generiert... Bitte warten Sie einen Moment."
      },
      "id": "processing-message",
      "name": "Verarbeitungsnachricht",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [900, 500]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chat_id }}",
        "text": "‚ùå Fehler beim Generieren des Videos. Bitte versuchen Sie es erneut."
      },
      "id": "error-message",
      "name": "Fehlermeldung",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1,
      "position": [2000, 500]
    }
  ],
  "connections": {
    "telegram-trigger": {
      "main": [
        [
          {
            "node": "command-filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "command-filter": {
      "main": [
        [
          {
            "node": "welcome-message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "video-command-filter",
            "type": "main",
            "index": 0
          },
          {
            "node": "upload-command-filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "video-command-filter": {
      "main": [
        [
          {
            "node": "extract-video-text",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "error-message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "extract-video-text": {
      "main": [
        [
          {
            "node": "processing-message",
            "type": "main",
            "index": 0
          },
          {
            "node": "text-to-speech",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "text-to-speech": {
      "main": [
        [
          {
            "node": "create-avatar-video",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "create-avatar-video": {
      "main": [
        [
          {
            "node": "check-video-status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "check-video-status": {
      "main": [
        [
          {
            "node": "video-ready-check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "video-ready-check": {
      "main": [
        [
          {
            "node": "download-video",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "check-video-status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "download-video": {
      "main": [
        [
          {
            "node": "send-video-telegram",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "upload-command-filter": {
      "main": [
        [
          {
            "node": "extract-upload-info",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "extract-upload-info": {
      "main": [
        [
          {
            "node": "social-login",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "social-login": {
      "main": [
        [
          {
            "node": "upload-to-social",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "upload-to-social": {
      "main": [
        [
          {
            "node": "upload-success",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2024-01-01T00:00:00.000Z",
  "versionId": "1"
}